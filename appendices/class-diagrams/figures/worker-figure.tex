\documentclass{standalone}
\usepackage{import}
\usepackage{tikz}
\usepackage{aeguill}
\begin{document}
% generated by Plantuml 1.2018.12      
\definecolor{plantucolor0000}{RGB}{255,255,255}
\definecolor{plantucolor0001}{RGB}{0,0,0}
\definecolor{plantucolor0002}{RGB}{255,255,255}
\definecolor{plantucolor0003}{RGB}{0,0,0}
\definecolor{plantucolor0004}{RGB}{200,41,48}
\definecolor{plantucolor0005}{RGB}{132,190,132}
\definecolor{plantucolor0006}{RGB}{3,128,72}
\definecolor{plantucolor0007}{RGB}{242,77,92}
\definecolor{plantucolor0008}{RGB}{255,255,255}
\definecolor{plantucolor0009}{RGB}{179,141,34}
\definecolor{plantucolor0010}{RGB}{255,255,68}
\definecolor{plantucolor0011}{RGB}{255,255,255}
\begin{tikzpicture}[yscale=-1
        ,pstyle0/.style={color=plantucolor0001,fill=plantucolor0000,line width=1.5pt}
        ,pstyle1/.style={color=plantucolor0001,fill=plantucolor0002,line width=1.0pt}
        ,pstyle2/.style={color=plantucolor0001,line width=1.5pt}
        ,pstyle3/.style={color=plantucolor0004,line width=1.0pt}
        ,pstyle4/.style={color=plantucolor0006,fill=plantucolor0005,line width=1.0pt}
        ,pstyle5/.style={color=plantucolor0004,fill=plantucolor0007,line width=1.0pt}
        ,pstyle6/.style={color=plantucolor0001,fill=plantucolor0008,line width=1.0pt}
        ,pstyle7/.style={color=plantucolor0009,line width=1.0pt}
        ,pstyle8/.style={color=plantucolor0006,line width=1.0pt}
        ,pstyle9/.style={color=plantucolor0009,fill=plantucolor0010,line width=1.0pt}
        ,pstyle11/.style={color=plantucolor0001,line width=1.0pt}
        ,pstyle12/.style={color=plantucolor0001,fill=plantucolor0001,line width=1.0pt}
    ]
    \draw[pstyle0] (898.5pt,116pt) rectangle (1264.0607pt,274pt);
    \draw[pstyle1] (1055.7081pt,132pt) ellipse (11pt and 11pt);
    \node at (1055.7081pt,132pt)[]{\textbf{\Large C}};
    \node at (1076.2081pt,126pt)[below right,color=black]{Worker};
    \draw[pstyle2] (899.5pt,148pt) -- (1263.0607pt,148pt);
    \draw[pstyle3] (906.5pt,156pt) rectangle (912.5pt,162pt);
    \node at (918.5pt,152pt)[below right,color=black]{\underline{Hashes : IDictionary\textless string, User\textgreater  \guillemotleft get\guillemotright  \guillemotleft set\guillemotright }};
    \draw[pstyle3] (906.5pt,167pt) rectangle (912.5pt,173pt);
    \node at (918.5pt,163pt)[below right,color=black]{Modules : IDictionary\textless Type, IModule\textgreater  \guillemotleft get\guillemotright  \guillemotleft set\guillemotright };
    \draw[pstyle3] (906.5pt,178pt) rectangle (912.5pt,184pt);
    \node at (918.5pt,174pt)[below right,color=black]{ModuleThreads : IList\textless Thread\textgreater  \guillemotleft get\guillemotright  \guillemotleft set\guillemotright };
    \draw[pstyle3] (906.5pt,189pt) rectangle (912.5pt,195pt);
    \node at (918.5pt,185pt)[below right,color=black]{Controller : IWorkerController \guillemotleft get\guillemotright  \guillemotleft set\guillemotright };
    \draw[pstyle2] (899.5pt,200pt) -- (1263.0607pt,200pt);
    \draw[pstyle4] (909.5pt,211pt) ellipse (3pt and 3pt);
    \node at (918.5pt,204pt)[below right,color=black]{Worker(controller:IWorkerController)};
    \draw[pstyle5] (906.5pt,219pt) rectangle (912.5pt,225pt);
    \node at (918.5pt,215pt)[below right,color=black]{RegisterModules() : void};
    \draw[pstyle4] (909.5pt,233pt) ellipse (3pt and 3pt);
    \node at (918.5pt,226pt)[below right,color=black]{\guillemotleft async\guillemotright  RunTool(type:Type, target:Target, user:User) : Task};
    \draw[pstyle4] (909.5pt,244pt) ellipse (3pt and 3pt);
    \node at (918.5pt,237pt)[below right,color=black]{\guillemotleft async\guillemotright  StartAsync(cancellationToken:CancellationToken) : Task};
    \draw[pstyle4] (909.5pt,255pt) ellipse (3pt and 3pt);
    \node at (918.5pt,248pt)[below right,color=black]{\guillemotleft async\guillemotright  StopAsync(cancellationToken:CancellationToken) : Task};
    \draw[pstyle4] (909.5pt,266pt) ellipse (3pt and 3pt);
    \node at (918.5pt,259pt)[below right,color=black]{\underline{ByteArrayToString(ba:byte[]) : string}};
    \draw[pstyle0] (1022.5pt,8pt) rectangle (1140.1274pt,56pt);
    \draw[pstyle1] (1037.5pt,24pt) ellipse (11pt and 11pt);
    \node at (1037.5pt,24pt)[]{\textbf{\Large C}};
    \node at (1051.5pt,18pt)[below right,color=black]{IHostedService};
    \draw[pstyle2] (1023.5pt,40pt) -- (1139.1274pt,40pt);
    \draw[pstyle2] (1023.5pt,48pt) -- (1139.1274pt,48pt);
    \draw[pstyle0] (620pt,508pt) rectangle (754.5091pt,589pt);
    \draw[pstyle6] (635pt,524pt) ellipse (11pt and 11pt);
    \node at (635pt,524pt)[]{\textbf{\Large I}};
    \node at (649pt,518pt)[below right,color=black]{\textit{IPersistantModule}};
    \draw[pstyle2] (621pt,540pt) -- (753.5091pt,540pt);
    \node at (626pt,544pt)[below right,color=black]{IsEnabled : bool \guillemotleft get\guillemotright };
    \draw[pstyle2] (621pt,559pt) -- (753.5091pt,559pt);
    \node at (626pt,563pt)[below right,color=black]{Run() : Task};
    \node at (626pt,574pt)[below right,color=black]{Stop() : Task};
    \draw[pstyle0] (904pt,361.5pt) rectangle (1018.9143pt,420.5pt);
    \draw[pstyle6] (935.0264pt,377.5pt) ellipse (11pt and 11pt);
    \node at (935.0264pt,377.5pt)[]{\textbf{\Large I}};
    \node at (952.5879pt,371.5pt)[below right,color=black]{\textit{IModule}};
    \draw[pstyle2] (905pt,393.5pt) -- (1017.9143pt,393.5pt);
    \node at (910pt,397.5pt)[below right,color=black]{Name : string \guillemotleft get\guillemotright };
    \draw[pstyle2] (905pt,412.5pt) -- (1017.9143pt,412.5pt);
    \draw[pstyle0] (1362pt,519pt) rectangle (1558.8867pt,578pt);
    \draw[pstyle6] (1419.7031pt,535pt) ellipse (11pt and 11pt);
    \node at (1419.7031pt,535pt)[]{\textbf{\Large I}};
    \node at (1440.2031pt,529pt)[below right,color=black]{\textit{IToolModule}};
    \draw[pstyle2] (1363pt,551pt) -- (1557.8867pt,551pt);
    \draw[pstyle2] (1363pt,559pt) -- (1557.8867pt,559pt);
    \node at (1368pt,563pt)[below right,color=black]{Run(target:Target, user:User) : Task};
    \draw[pstyle0] (834pt,508pt) rectangle (1147.4486pt,589pt);
    \draw[pstyle1] (951.6743pt,524pt) ellipse (11pt and 11pt);
    \node at (951.6743pt,524pt)[]{\textbf{\Large C}};
    \node at (972.1743pt,518pt)[below right,color=black]{BaseModule};
    \draw[pstyle2] (835pt,540pt) -- (1146.4486pt,540pt);
    \draw[pstyle7] (845pt,546pt) -- (849pt,550pt) -- (845pt,554pt) -- (841pt,550pt) -- cycle;
    \node at (854pt,544pt)[below right,color=black]{Controller : IWorkerController \guillemotleft get\guillemotright };
    \draw[pstyle8] (845pt,562pt) ellipse (3pt and 3pt);
    \node at (854pt,555pt)[below right,color=black]{Name : string \guillemotleft get\guillemotright };
    \draw[pstyle2] (835pt,570pt) -- (1146.4486pt,570pt);
    \draw[pstyle9] (845pt,576pt) -- (849pt,580pt) -- (845pt,584pt) -- (841pt,580pt) -- cycle;
    \node at (854pt,574pt)[below right,color=black]{BaseModule(controller:IWorkerController, name:string)};
    \draw[pstyle0] (1054.5pt,334pt) rectangle (1350.9063pt,448pt);
    \draw[pstyle6] (1146.8531pt,350pt) ellipse (11pt and 11pt);
    \node at (1146.8531pt,350pt)[]{\textbf{\Large I}};
    \node at (1167.3531pt,344pt)[below right,color=black]{\textit{IWorkerController}};
    \draw[pstyle2] (1055.5pt,366pt) -- (1349.9063pt,366pt);
    \node at (1060.5pt,370pt)[below right,color=black]{WorkerSettings : IWorkerSettings \guillemotleft get\guillemotright };
    \node at (1060.5pt,381pt)[below right,color=black]{DataStore : IDataStore \guillemotleft get\guillemotright };
    \draw[pstyle2] (1055.5pt,396pt) -- (1349.9063pt,396pt);
    \node at (1060.5pt,400pt)[below right,color=black]{Add(name:string, entity:T) : Task};
    \node at (1060.5pt,411pt)[below right,color=black]{Log(name:string, value:string, args:object[]) : Task};
    \node at (1060.5pt,422pt)[below right,color=black]{Dump(target:Target, user:User) : Task};
    \node at (1060.5pt,433pt)[below right,color=black]{SynchronizeTool(type:Type, tool:IToolModule) : void};
    \draw[pstyle0] (1299pt,693pt) rectangle (1982.3368pt,829pt);
    \draw[pstyle1] (1590.3348pt,709pt) ellipse (11pt and 11pt);
    \node at (1590.3348pt,709pt)[]{\textbf{\Large C}};
    \node at (1610.8348pt,703pt)[below right,color=black]{LsassDumpTool};
    \draw[pstyle2] (1300pt,725pt) -- (1981.3368pt,725pt);
    \draw[pstyle2] (1300pt,733pt) -- (1981.3368pt,733pt);
    \draw[pstyle4] (1310pt,744pt) ellipse (3pt and 3pt);
    \node at (1319pt,737pt)[below right,color=black]{LsassDumpTool(controller:IWorkerController)};
    \draw[pstyle4] (1310pt,755pt) ellipse (3pt and 3pt);
    \node at (1319pt,748pt)[below right,color=black]{\guillemotleft async\guillemotright  Run(target:Target, user:User) : Task};
    \draw[pstyle5] (1307pt,763pt) rectangle (1313pt,769pt);
    \node at (1319pt,759pt)[below right,color=black]{\guillemotleft async\guillemotright  RunMimikatz(dumpFilePath:string) : Task};
    \draw[pstyle5] (1307pt,774pt) rectangle (1313pt,780pt);
    \node at (1319pt,770pt)[below right,color=black]{\guillemotleft async\guillemotright  ParseMimikatzOutput(output:string) : Task};
    \draw[pstyle5] (1307pt,785pt) rectangle (1313pt,791pt);
    \node at (1319pt,781pt)[below right,color=black]{\guillemotleft async\guillemotright  ParseMimikatzLine(line:string) : Task\textless string\textgreater };
    \draw[pstyle5] (1307pt,796pt) rectangle (1313pt,802pt);
    \node at (1319pt,792pt)[below right,color=black]{\guillemotleft async\guillemotright  RunProcess(target:Target, user:User, command:string, getArguments:Func\textless Target, User, string, string\textgreater ) : Task\textless bool\textgreater };
    \draw[pstyle5] (1307pt,807pt) rectangle (1313pt,813pt);
    \node at (1319pt,803pt)[below right,color=black]{GetClearTextArguments(target:Target, user:User, command:string) : string};
    \draw[pstyle5] (1307pt,818pt) rectangle (1313pt,824pt);
    \node at (1319pt,814pt)[below right,color=black]{GetNTLMArguments(target:Target, user:User, command:string) : string};
    \draw[pstyle0] (756.5pt,933pt) rectangle (1022.1pt,1014pt);
    \draw[pstyle6] (860.7915pt,949pt) ellipse (11pt and 11pt);
    \node at (860.7915pt,949pt)[]{\textbf{\Large I}};
    \node at (881.2915pt,943pt)[below right,color=black]{\textit{ISpoofer}};
    \draw[pstyle2] (757.5pt,965pt) -- (1021.1pt,965pt);
    \draw[pstyle2] (757.5pt,973pt) -- (1021.1pt,973pt);
    \node at (762.5pt,977pt)[below right,color=black]{HandlePacket(state:SpooferPacket) : Task};
    \node at (762.5pt,988pt)[below right,color=black]{HandleRequestPacket(state:SpooferPacket) : Task};
    \node at (762.5pt,999pt)[below right,color=black]{SpoofPacket(state:SpooferPacket) : Task};
    \draw[pstyle0] (304.5pt,1303pt) rectangle (874.6574pt,1417pt);
    \draw[pstyle1] (538.5287pt,1319pt) ellipse (11pt and 11pt);
    \node at (538.5287pt,1319pt)[]{\textbf{\Large C}};
    \node at (559.0287pt,1313pt)[below right,color=black]{LLMNRSpoofer};
    \draw[pstyle2] (305.5pt,1335pt) -- (873.6574pt,1335pt);
    \draw[pstyle3] (312.5pt,1343pt) rectangle (318.5pt,1349pt);
    \node at (324.5pt,1339pt)[below right,color=black]{\guillemotleft const\guillemotright  StaticPacketLength : int = 18};
    \draw[pstyle7] (315.5pt,1352pt) -- (319.5pt,1356pt) -- (315.5pt,1360pt) -- (311.5pt,1356pt) -- cycle;
    \node at (324.5pt,1350pt)[below right,color=black]{\guillemotleft override\guillemotright  Protocol : string \guillemotleft get\guillemotright };
    \draw[pstyle2] (305.5pt,1365pt) -- (873.6574pt,1365pt);
    \draw[pstyle4] (315.5pt,1376pt) ellipse (3pt and 3pt);
    \node at (324.5pt,1369pt)[below right,color=black]{LLMNRSpoofer(controller:IWorkerController, settings:SpooferSettings, socketType:Models.SocketType)};
    \draw[pstyle9] (315.5pt,1382pt) -- (319.5pt,1386pt) -- (315.5pt,1390pt) -- (311.5pt,1386pt) -- cycle;
    \node at (324.5pt,1380pt)[below right,color=black]{\guillemotleft override\guillemotright  GetPacket(data:byte[], ip:byte[]) : IPacket};
    \draw[pstyle9] (315.5pt,1393pt) -- (319.5pt,1397pt) -- (315.5pt,1401pt) -- (311.5pt,1397pt) -- cycle;
    \node at (324.5pt,1391pt)[below right,color=black]{\guillemotleft override\guillemotright  CheckRules(state:SpooferPacket) : bool};
    \draw[pstyle9] (315.5pt,1404pt) -- (319.5pt,1408pt) -- (315.5pt,1412pt) -- (311.5pt,1408pt) -- cycle;
    \node at (324.5pt,1402pt)[below right,color=black]{\guillemotleft override\guillemotright  GetName(state:SpooferPacket) : string};
    \draw[pstyle0] (586.5pt,1074pt) rectangle (1192.4462pt,1243pt);
    \draw[color=plantucolor0001,fill=plantucolor0011,line width=1.0pt] (849.9564pt,1090pt) ellipse (11pt and 11pt);
    \node at (849.9564pt,1090pt)[]{\textbf{\Large A}};
    \node at (870.4564pt,1084pt)[below right,color=black]{\textit{BaseSpoofer}};
    \draw[pstyle2] (587.5pt,1106pt) -- (1191.4462pt,1106pt);
    \draw[pstyle7] (597.5pt,1112pt) -- (601.5pt,1116pt) -- (597.5pt,1120pt) -- (593.5pt,1116pt) -- cycle;
    \node at (606.5pt,1110pt)[below right,color=black]{Settings : SpooferSettings \guillemotleft get\guillemotright  \guillemotleft set\guillemotright };
    \draw[pstyle7] (597.5pt,1123pt) -- (601.5pt,1127pt) -- (597.5pt,1131pt) -- (593.5pt,1127pt) -- cycle;
    \node at (606.5pt,1121pt)[below right,color=black]{SocketType : Models.SocketType \guillemotleft get\guillemotright  \guillemotleft set\guillemotright };
    \draw[pstyle7] (597.5pt,1134pt) -- (601.5pt,1138pt) -- (597.5pt,1142pt) -- (593.5pt,1138pt) -- cycle;
    \node at (606.5pt,1132pt)[below right,color=black]{Controller : IWorkerController \guillemotleft get\guillemotright };
    \draw[pstyle7] (597.5pt,1145pt) -- (601.5pt,1149pt) -- (597.5pt,1153pt) -- (593.5pt,1149pt) -- cycle;
    \node at (606.5pt,1143pt)[below right,color=black]{\textit{Protocol : string \guillemotleft get\guillemotright }};
    \draw[pstyle2] (587.5pt,1158pt) -- (1191.4462pt,1158pt);
    \node at (606.5pt,1162pt)[below right,color=black]{\guillemotleft internal\guillemotright  BaseSpoofer(controller:IWorkerController, settings:SpooferSettings, socketType:Models.SocketType)};
    \draw[pstyle9] (597.5pt,1175pt) -- (601.5pt,1179pt) -- (597.5pt,1183pt) -- (593.5pt,1179pt) -- cycle;
    \node at (606.5pt,1173pt)[below right,color=black]{\textit{CheckRules(state:SpooferPacket) : bool}};
    \draw[pstyle9] (597.5pt,1186pt) -- (601.5pt,1190pt) -- (597.5pt,1194pt) -- (593.5pt,1190pt) -- cycle;
    \node at (606.5pt,1184pt)[below right,color=black]{\textit{GetName(state:SpooferPacket) : string}};
    \draw[pstyle9] (597.5pt,1197pt) -- (601.5pt,1201pt) -- (597.5pt,1205pt) -- (593.5pt,1201pt) -- cycle;
    \node at (606.5pt,1195pt)[below right,color=black]{\textit{GetPacket(data:byte[], ip:byte[]) : IPacket}};
    \draw[pstyle4] (597.5pt,1213pt) ellipse (3pt and 3pt);
    \node at (606.5pt,1206pt)[below right,color=black]{\guillemotleft async\guillemotright  HandlePacket(state:SpooferPacket) : Task};
    \draw[pstyle4] (597.5pt,1224pt) ellipse (3pt and 3pt);
    \node at (606.5pt,1217pt)[below right,color=black]{\guillemotleft async\guillemotright  HandleRequestPacket(state:SpooferPacket) : Task};
    \draw[pstyle4] (597.5pt,1235pt) ellipse (3pt and 3pt);
    \node at (606.5pt,1228pt)[below right,color=black]{\guillemotleft async\guillemotright  SpoofPacket(state:SpooferPacket) : Task};
    \draw[pstyle0] (805.5pt,660pt) rectangle (1263.2181pt,862pt);
    \draw[pstyle1] (994.0992pt,676pt) ellipse (11pt and 11pt);
    \node at (994.0992pt,676pt)[]{\textbf{\Large C}};
    \node at (1014.5992pt,670pt)[below right,color=black]{SpooferCore};
    \draw[pstyle2] (806.5pt,692pt) -- (1262.2181pt,692pt);
    \draw[pstyle3] (813.5pt,700pt) rectangle (819.5pt,706pt);
    \node at (825.5pt,696pt)[below right,color=black]{Settings : SpooferSettings \guillemotleft get\guillemotright  \guillemotleft set\guillemotright };
    \draw[pstyle3] (813.5pt,711pt) rectangle (819.5pt,717pt);
    \node at (825.5pt,707pt)[below right,color=black]{UDP137Socket : Models.SocketType};
    \draw[pstyle3] (813.5pt,722pt) rectangle (819.5pt,728pt);
    \node at (825.5pt,718pt)[below right,color=black]{UDP5355Socket : Models.SocketType};
    \draw[pstyle3] (813.5pt,733pt) rectangle (819.5pt,739pt);
    \node at (825.5pt,729pt)[below right,color=black]{Spoofers : IDictionary\textless Models.SocketType, List\textless ISpoofer\textgreater \textgreater  \guillemotleft get\guillemotright  \guillemotleft set\guillemotright };
    \draw[pstyle3] (813.5pt,744pt) rectangle (819.5pt,750pt);
    \node at (825.5pt,740pt)[below right,color=black]{SocketTypes : IList\textless Models.SocketType\textgreater  \guillemotleft get\guillemotright  \guillemotleft set\guillemotright };
    \draw[pstyle8] (816.5pt,758pt) ellipse (3pt and 3pt);
    \node at (825.5pt,751pt)[below right,color=black]{IsEnabled : bool \guillemotleft get\guillemotright };
    \draw[pstyle2] (806.5pt,766pt) -- (1262.2181pt,766pt);
    \node at (825.5pt,770pt)[below right,color=black]{\guillemotleft internal\guillemotright  SpooferCore(controller:IWorkerController, settings:SpooferSettings)};
    \draw[pstyle4] (816.5pt,788pt) ellipse (3pt and 3pt);
    \node at (825.5pt,781pt)[below right,color=black]{\guillemotleft async\guillemotright  Run() : Task};
    \draw[pstyle4] (816.5pt,799pt) ellipse (3pt and 3pt);
    \node at (825.5pt,792pt)[below right,color=black]{\guillemotleft async\guillemotright  Stop() : Task};
    \draw[pstyle5] (813.5pt,807pt) rectangle (819.5pt,813pt);
    \node at (825.5pt,803pt)[below right,color=black]{AddSpoofer(socketType:Models.SocketType, spoofer:ISpoofer, run:bool) : void};
    \draw[pstyle5] (813.5pt,818pt) rectangle (819.5pt,824pt);
    \node at (825.5pt,814pt)[below right,color=black]{\guillemotleft async\guillemotright  StartSocket(socketType:Models.SocketType) : Task};
    \draw[pstyle5] (813.5pt,829pt) rectangle (819.5pt,835pt);
    \node at (825.5pt,825pt)[below right,color=black]{\guillemotleft async\guillemotright  StartSockets() : Task};
    \draw[pstyle5] (813.5pt,840pt) rectangle (819.5pt,846pt);
    \node at (825.5pt,836pt)[below right,color=black]{\guillemotleft async\guillemotright  BeginReceiveSockets() : Task};
    \draw[pstyle4] (816.5pt,854pt) ellipse (3pt and 3pt);
    \node at (825.5pt,847pt)[below right,color=black]{\guillemotleft async\guillemotright  ReadCallback(result:IAsyncResult, socketType:Models.SocketType) : Task};
    \draw[pstyle0] (1057.5pt,933pt) rectangle (1301.9195pt,1014pt);
    \draw[pstyle1] (1130.8861pt,949pt) ellipse (11pt and 11pt);
    \node at (1130.8861pt,949pt)[]{\textbf{\Large C}};
    \node at (1151.3861pt,943pt)[below right,color=black]{SpooferSettings};
    \draw[pstyle2] (1058.5pt,965pt) -- (1300.9195pt,965pt);
    \node at (1063.5pt,969pt)[below right,color=black]{\guillemotleft internal\guillemotright  NBNS : bool \guillemotleft get\guillemotright  \guillemotleft set\guillemotright  = true};
    \node at (1063.5pt,980pt)[below right,color=black]{\guillemotleft internal\guillemotright  LLMNR : bool \guillemotleft get\guillemotright  \guillemotleft set\guillemotright  = true};
    \node at (1063.5pt,991pt)[below right,color=black]{\guillemotleft internal\guillemotright  Inspect : bool \guillemotleft get\guillemotright  \guillemotleft set\guillemotright  = false};
    \draw[pstyle2] (1058.5pt,1006pt) -- (1300.9195pt,1006pt);
    \draw[pstyle0] (910pt,1303pt) rectangle (1469.1314pt,1417pt);
    \draw[pstyle1] (1144.1241pt,1319pt) ellipse (11pt and 11pt);
    \node at (1144.1241pt,1319pt)[]{\textbf{\Large C}};
    \node at (1164.6241pt,1313pt)[below right,color=black]{NBNSSpoofer};
    \draw[pstyle2] (911pt,1335pt) -- (1468.1314pt,1335pt);
    \draw[pstyle7] (921pt,1341pt) -- (925pt,1345pt) -- (921pt,1349pt) -- (917pt,1345pt) -- cycle;
    \node at (930pt,1339pt)[below right,color=black]{\guillemotleft override\guillemotright  Protocol : string \guillemotleft get\guillemotright };
    \draw[pstyle2] (911pt,1354pt) -- (1468.1314pt,1354pt);
    \draw[pstyle4] (921pt,1365pt) ellipse (3pt and 3pt);
    \node at (930pt,1358pt)[below right,color=black]{NBNSSpoofer(controller:IWorkerController, settings:SpooferSettings, socketType:Models.SocketType)};
    \draw[pstyle9] (921pt,1371pt) -- (925pt,1375pt) -- (921pt,1379pt) -- (917pt,1375pt) -- cycle;
    \node at (930pt,1369pt)[below right,color=black]{\guillemotleft override\guillemotright  GetPacket(data:byte[], ip:byte[]) : IPacket};
    \draw[pstyle9] (921pt,1382pt) -- (925pt,1386pt) -- (921pt,1390pt) -- (917pt,1386pt) -- cycle;
    \node at (930pt,1380pt)[below right,color=black]{\guillemotleft override\guillemotright  CheckRules(state:SpooferPacket) : bool};
    \draw[pstyle9] (921pt,1393pt) -- (925pt,1397pt) -- (921pt,1401pt) -- (917pt,1397pt) -- cycle;
    \node at (930pt,1391pt)[below right,color=black]{\guillemotleft override\guillemotright  GetName(state:SpooferPacket) : string};
    \draw[pstyle5] (918pt,1406pt) rectangle (924pt,1412pt);
    \node at (930pt,1402pt)[below right,color=black]{\underline{DecodeName(bytes:byte[]) : string}};
    \draw[pstyle0] (6pt,649pt) rectangle (395.4667pt,873pt);
    \draw[pstyle1] (163.5465pt,665pt) ellipse (11pt and 11pt);
    \node at (163.5465pt,665pt)[]{\textbf{\Large C}};
    \node at (184.0465pt,659pt)[below right,color=black]{SMBServer};
    \draw[pstyle2] (7pt,681pt) -- (394.4667pt,681pt);
    \draw[pstyle3] (14pt,689pt) rectangle (20pt,695pt);
    \node at (26pt,685pt)[below right,color=black]{\underline{mre : ManualResetEvent}};
    \draw[pstyle3] (14pt,700pt) rectangle (20pt,706pt);
    \node at (26pt,696pt)[below right,color=black]{Socket : Socket \guillemotleft get\guillemotright  \guillemotleft set\guillemotright };
    \draw[pstyle8] (17pt,714pt) ellipse (3pt and 3pt);
    \node at (26pt,707pt)[below right,color=black]{IsEnabled : bool \guillemotleft get\guillemotright };
    \draw[pstyle2] (7pt,722pt) -- (394.4667pt,722pt);
    \draw[pstyle4] (17pt,733pt) ellipse (3pt and 3pt);
    \node at (26pt,726pt)[below right,color=black]{SMBServer(controller:IWorkerController)};
    \draw[pstyle4] (17pt,744pt) ellipse (3pt and 3pt);
    \node at (26pt,737pt)[below right,color=black]{\guillemotleft async\guillemotright  Run() : Task};
    \draw[pstyle4] (17pt,755pt) ellipse (3pt and 3pt);
    \node at (26pt,748pt)[below right,color=black]{\guillemotleft async\guillemotright  Stop() : Task};
    \draw[pstyle5] (14pt,763pt) rectangle (20pt,769pt);
    \node at (26pt,759pt)[below right,color=black]{\guillemotleft async\guillemotright  StartSocket() : Task};
    \draw[pstyle5] (14pt,774pt) rectangle (20pt,780pt);
    \node at (26pt,770pt)[below right,color=black]{\guillemotleft async\guillemotright  AcceptCallback(asyncResult:IAsyncResult) : Task};
    \draw[pstyle5] (14pt,785pt) rectangle (20pt,791pt);
    \node at (26pt,781pt)[below right,color=black]{\guillemotleft async\guillemotright  ReadCallback(asyncResult:IAsyncResult) : Task};
    \draw[pstyle5] (14pt,796pt) rectangle (20pt,802pt);
    \node at (26pt,792pt)[below right,color=black]{\guillemotleft async\guillemotright  ParseHash(packet:SMBPacket) : Task};
    \draw[pstyle5] (14pt,807pt) rectangle (20pt,813pt);
    \node at (26pt,803pt)[below right,color=black]{\guillemotleft async\guillemotright  NegotiateSMB1ToSMB2Response(packet:SMBPacket) : Task};
    \draw[pstyle5] (14pt,818pt) rectangle (20pt,824pt);
    \node at (26pt,814pt)[below right,color=black]{\guillemotleft async\guillemotright  NegotiateResponse(packet:SMBPacket) : Task};
    \draw[pstyle5] (14pt,829pt) rectangle (20pt,835pt);
    \node at (26pt,825pt)[below right,color=black]{\guillemotleft async\guillemotright  NegotiateNTLMResponse(packet:SMBPacket) : Task};
    \draw[pstyle5] (14pt,840pt) rectangle (20pt,846pt);
    \node at (26pt,836pt)[below right,color=black]{\guillemotleft async\guillemotright  SendAccessDenied(packet:SMBPacket) : Task};
    \draw[pstyle5] (14pt,851pt) rectangle (20pt,857pt);
    \node at (26pt,847pt)[below right,color=black]{\guillemotleft async\guillemotright  Send(handler:Socket, data:byte[]) : Task};
    \draw[pstyle5] (14pt,862pt) rectangle (20pt,868pt);
    \node at (26pt,858pt)[below right,color=black]{\guillemotleft async\guillemotright  SendCallback(ar:IAsyncResult) : Task};
    \draw[pstyle0] (430.5pt,682pt) rectangle (770.127pt,840pt);
    \draw[pstyle1] (560.2504pt,698pt) ellipse (11pt and 11pt);
    \node at (560.2504pt,698pt)[]{\textbf{\Large C}};
    \node at (580.7504pt,692pt)[below right,color=black]{HTTPServer};
    \draw[pstyle2] (431.5pt,714pt) -- (769.127pt,714pt);
    \draw[pstyle3] (438.5pt,722pt) rectangle (444.5pt,728pt);
    \node at (450.5pt,718pt)[below right,color=black]{Listener : HttpListener \guillemotleft get\guillemotright  \guillemotleft set\guillemotright };
    \draw[pstyle3] (438.5pt,733pt) rectangle (444.5pt,739pt);
    \node at (450.5pt,729pt)[below right,color=black]{Port : int \guillemotleft get\guillemotright  \guillemotleft set\guillemotright };
    \draw[pstyle8] (441.5pt,747pt) ellipse (3pt and 3pt);
    \node at (450.5pt,740pt)[below right,color=black]{IsEnabled : bool \guillemotleft get\guillemotright };
    \draw[pstyle2] (431.5pt,755pt) -- (769.127pt,755pt);
    \draw[pstyle4] (441.5pt,766pt) ellipse (3pt and 3pt);
    \node at (450.5pt,759pt)[below right,color=black]{HTTPServer(controller:IWorkerController, port:int)};
    \draw[pstyle4] (441.5pt,777pt) ellipse (3pt and 3pt);
    \node at (450.5pt,770pt)[below right,color=black]{\guillemotleft async\guillemotright  Run() : Task};
    \draw[pstyle4] (441.5pt,788pt) ellipse (3pt and 3pt);
    \node at (450.5pt,781pt)[below right,color=black]{\guillemotleft async\guillemotright  Stop() : Task};
    \draw[pstyle5] (438.5pt,796pt) rectangle (444.5pt,802pt);
    \node at (450.5pt,792pt)[below right,color=black]{\guillemotleft async\guillemotright  Listen() : Task};
    \draw[pstyle5] (438.5pt,807pt) rectangle (444.5pt,813pt);
    \node at (450.5pt,803pt)[below right,color=black]{\guillemotleft async\guillemotright  Process(context:HttpListenerContext) : Task};
    \draw[pstyle5] (438.5pt,818pt) rectangle (444.5pt,824pt);
    \node at (450.5pt,814pt)[below right,color=black]{\guillemotleft async\guillemotright  GetNTLMHash(context:HttpListenerContext) : Task};
    \draw[pstyle5] (438.5pt,829pt) rectangle (444.5pt,835pt);
    \node at (450.5pt,825pt)[below right,color=black]{Initialize(port:int) : void};
    \draw[pstyle11] (1081.5pt,76.2978pt) ..controls (1081.5pt,88.5925pt) and (1081.5pt,102.3252pt) .. (1081.5pt,115.9657pt);
    \draw[pstyle11] (1074.5001pt,76.0512pt) -- (1081.5pt,56.0512pt) -- (1088.5001pt,76.0512pt) -- (1074.5001pt,76.0512pt) -- cycle;
    \draw[pstyle11] (892.4166pt,430.7103pt) ..controls (850.3713pt,454.8787pt) and (796.9016pt,485.614pt) .. (755.1246pt,509.6282pt);
    \draw[pstyle11] (889.1347pt,424.5228pt) -- (909.9627pt,420.6245pt) -- (896.1117pt,436.6605pt) -- (889.1347pt,424.5228pt) -- cycle;
    \draw[pstyle11] (1010.4817pt,432.713pt) ..controls (1018.8031pt,438.4567pt) and (1027.632pt,443.811pt) .. (1036.5pt,448pt) ..controls (1141.6697pt,497.6792pt) and (1273.4508pt,523.9359pt) .. (1361.9433pt,536.985pt);
    \draw[pstyle11] (1006.1159pt,438.1895pt) -- (994.2635pt,420.6248pt) -- (1014.4825pt,426.9645pt) -- (1006.1159pt,438.1895pt) -- cycle;
    \draw[pstyle11] (1133.8043pt,595.3495pt) ..controls (1221.4106pt,623.99pt) and (1334.9704pt,661.1153pt) .. (1432.3729pt,692.9584pt);
    \draw[pstyle11] (1131.5082pt,601.9635pt) -- (1114.6735pt,589.0952pt) -- (1135.8586pt,588.6566pt) -- (1131.5082pt,601.9635pt) -- cycle;
    \draw[pstyle11] (1498.5671pt,593.4403pt) ..controls (1522.9875pt,622.27pt) and (1555.1626pt,660.2545pt) .. (1582.7034pt,692.7679pt);
    \draw[pstyle11] (1493.1138pt,597.8326pt) -- (1485.5282pt,578.0472pt) -- (1503.7965pt,588.7837pt) -- (1493.1138pt,597.8326pt) -- cycle;
    \draw[pstyle11] (746.9592pt,1254.2399pt) ..controls (722.2206pt,1270.856pt) and (697.2108pt,1287.6542pt) .. (674.6303pt,1302.8208pt);
    \draw[pstyle11] (743.0713pt,1248.4189pt) -- (763.577pt,1243.0783pt) -- (750.8774pt,1260.0407pt) -- (743.0713pt,1248.4189pt) -- cycle;
    \draw[pstyle11] (1003.031pt,609.0192pt) ..controls (1006.328pt,624.9421pt) and (1009.9756pt,642.5584pt) .. (1013.5842pt,659.9864pt);
    \draw[pstyle11] (996.1322pt,610.2246pt) -- (998.9316pt,589.2207pt) -- (1009.8414pt,607.386pt) -- (996.1322pt,610.2246pt) -- cycle;
    \draw[pstyle11] (771.3307pt,599.8372pt) ..controls (801.001pt,618.0071pt) and (835.496pt,639.1316pt) .. (869.5507pt,659.9864pt);
    \draw[pstyle11] (767.3947pt,605.6352pt) -- (753.9945pt,589.2207pt) -- (774.7062pt,593.6961pt) -- (767.3947pt,605.6352pt) -- cycle;
    \draw[pstyle11] (889.5pt,1034.3815pt) ..controls (889.5pt,1047.0564pt) and (889.5pt,1060.6317pt) .. (889.5pt,1073.9834pt);
    \draw[pstyle11] (882.5001pt,1034.0991pt) -- (889.5pt,1014.099pt) -- (896.5001pt,1034.099pt) -- (882.5001pt,1034.0991pt) -- cycle;
    \draw[pstyle11] (1032.0408pt,1254.2399pt) ..controls (1056.7794pt,1270.856pt) and (1081.7892pt,1287.6542pt) .. (1104.3697pt,1302.8208pt);
    \draw[pstyle11] (1028.1226pt,1260.0407pt) -- (1015.423pt,1243.0783pt) -- (1035.9287pt,1248.4189pt) -- (1028.1226pt,1260.0407pt) -- cycle;
    \draw[pstyle11] (814.0844pt,581.5622pt) ..controls (800.0201pt,584.1102pt) and (786.0279pt,586.6163pt) .. (772.5pt,589pt) ..controls (612.754pt,617.1485pt) and (566.185pt,597.1151pt) .. (412.5pt,649pt) ..controls (406.7813pt,650.9307pt) and (401.0303pt,653.0019pt) .. (395.269pt,655.1917pt);
    \draw[pstyle11] (813.0448pt,574.6365pt) -- (833.9753pt,577.9403pt) -- (815.5528pt,588.41pt) -- (813.0448pt,574.6365pt) -- cycle;
    \draw[pstyle11] (600.8307pt,576.7949pt) ..controls (546.0859pt,595.4925pt) and (474.2767pt,621.5452pt) .. (412.5pt,649pt) ..controls (406.7942pt,651.5358pt) and (401.0292pt,654.1589pt) .. (395.2315pt,656.8505pt);
    \draw[pstyle11] (598.6191pt,570.1535pt) -- (619.8076pt,570.3741pt) -- (603.1062pt,583.4149pt) -- (598.6191pt,570.1535pt) -- cycle;
    \draw[pstyle11] (886.8065pt,597.851pt) ..controls (854.6979pt,613.6616pt) and (819.3885pt,631.5931pt) .. (787.5pt,649pt) ..controls (768.5667pt,659.3351pt) and (748.794pt,670.6203pt) .. (729.4943pt,681.9202pt);
    \draw[pstyle11] (883.7392pt,591.5588pt) -- (904.7805pt,589.0556pt) -- (889.8928pt,604.134pt) -- (883.7392pt,591.5588pt) -- cycle;
    \draw[pstyle11] (663.2021pt,607.8482pt) ..controls (653.8382pt,630.7199pt) and (642.9891pt,657.2192pt) .. (632.9746pt,681.6799pt);
    \draw[pstyle11] (656.7726pt,605.0773pt) -- (670.8285pt,589.2207pt) -- (669.7288pt,610.3818pt) -- (656.7726pt,605.0773pt) -- cycle;
    \draw[pstyle11] (957.9923pt,873.1234pt) ..controls (943.3963pt,894.514pt) and (929.0177pt,915.5861pt) .. (917.2324pt,932.8578pt);
    \draw[pstyle12] (965.3973pt,862.2712pt) -- (958.7114pt,864.9728pt) -- (958.6336pt,872.1835pt) -- (965.3196pt,869.4819pt) -- (965.3973pt,862.2712pt) -- cycle;
    \node at (953.3315pt,869.8489pt)[below right,color=black]{1};
    \node at (898.07pt,912.0499pt)[below right,color=black]{0..*};
    \draw[pstyle11] (1111.0077pt,873.1234pt) ..controls (1125.6037pt,894.514pt) and (1139.9823pt,915.5861pt) .. (1151.7676pt,932.8578pt);
    \draw[pstyle12] (1103.6027pt,862.2712pt) -- (1103.6804pt,869.4819pt) -- (1110.3664pt,872.1835pt) -- (1110.2886pt,864.9728pt) -- (1103.6027pt,862.2712pt) -- cycle;
    \node at (1101.2544pt,869.8489pt)[below right,color=black]{1};
    \node at (1139.6286pt,912.0499pt)[below right,color=black]{1};
    \draw[pstyle11] (1026.1767pt,285.3613pt) ..controls (1009.4786pt,312.635pt) and (992.2944pt,340.7024pt) .. (979.8397pt,361.0452pt);
    \draw[pstyle12] (1033.0373pt,274.1557pt) -- (1026.493pt,277.1842pt) -- (1026.7714pt,284.3899pt) -- (1033.3158pt,281.3614pt) -- (1033.0373pt,274.1557pt) -- cycle;
    \node at (1021.3054pt,282.0521pt)[below right,color=black]{1};
    \node at (959.4036pt,340.5264pt)[below right,color=black]{0..*};
    \draw[pstyle11] (1137.3591pt,285.4826pt) ..controls (1147.5206pt,301.9424pt) and (1157.8576pt,318.6868pt) .. (1167.2147pt,333.8436pt);
    \draw[pstyle12] (1130.3666pt,274.1557pt) -- (1130.1148pt,281.3624pt) -- (1136.6703pt,284.3666pt) -- (1136.9221pt,277.1599pt) -- (1130.3666pt,274.1557pt) -- cycle;
    \node at (1127.6073pt,282.0521pt)[below right,color=black]{1};
    \node at (1155.5135pt,313.0855pt)[below right,color=black]{1};
\end{tikzpicture}

\end{document}