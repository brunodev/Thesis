@startuml
enum InstanceState {
    None= 0,
    Local= 1,
    Registered= 2,
    NoRebootRequired= 4,
    NoErrors= 8,
    Complete= 4294967295,
}
interface IEnumSetupInstances {
    Next(celt:int, rgelt:ISetupInstance[], pceltFetched:int) : void
    Skip(celt:int) : void
    Reset() : void
    Clone() : IEnumSetupInstances
}
interface ISetupConfiguration {
}
interface ISetupConfiguration2 {
    EnumInstances() : IEnumSetupInstances
    GetInstanceForCurrentProcess() : ISetupInstance
    GetInstanceForPath(path:string) : ISetupInstance
    EnumAllInstances() : IEnumSetupInstances
}
interface ISetupInstance {
}
interface ISetupInstance2 {
    GetInstanceId() : string
    GetInstallDate() : System.Runtime.InteropServices.ComTypes.FILETIME
    GetInstallationName() : string
    GetInstallationPath() : string
    GetInstallationVersion() : string
    GetDisplayName(lcid:int) : string
    GetDescription(lcid:int) : string
    ResolvePath(pwszRelativePath:string) : string
    GetState() : InstanceState
    GetPackages() : ISetupPackageReference[]
    GetProduct() : ISetupPackageReference
    GetProductPath() : string
    IsLaunchable() : bool
    IsComplete() : bool
    GetProperties() : ISetupPropertyStore
    GetEnginePath() : string
}
interface ISetupPackageReference {
    GetId() : string
    GetVersion() : string
    GetChip() : string
    GetLanguage() : string
    GetBranch() : string
    GetType() : string
    GetUniqueId() : string
    GetIsExtension() : bool
}
interface ISetupPropertyStore {
    GetNames() : string[]
    GetValue(pwszName:string) : object
}
interface SetupConfiguration {
}
class SetupConfigurationClass {
}
class Main <<static>> {
    + {static} Query() : void
    - {static} CheckInstance(setupInstance2:ISetupInstance2, log:StringBuilder) : bool
}
ISetupConfiguration <|-- ISetupConfiguration2
ISetupInstance <|-- ISetupInstance2
ISetupConfiguration2 <|-- SetupConfiguration
ISetupConfiguration <|-- SetupConfiguration
@enduml
